\documentclass[a5paper]{article}
\usepackage[a5paper, top=8mm, bottom=8mm, left=8mm, right=8mm]{geometry}

\usepackage{polyglossia}
\setdefaultlanguage[babelshorthands=true]{russian}

\usepackage{fontspec}
\setmainfont{FreeSerif}
\newfontfamily{\russianfonttt}[Scale=0.7]{DejaVuSansMono}

\usepackage[font=scriptsize]{caption}

\PassOptionsToPackage{hyphens}{url}\usepackage[xetex,linktocpage=true,plainpages=false,pdfpagelabels=false]{hyperref}
\hypersetup{colorlinks=true, linkcolor=blue, citecolor=blue, filecolor=blue, urlcolor=blue, pdftitle=1, pdfauthor=, pdfsubject=, pdfkeywords=}

\usepackage{tabu}

\tabulinesep=1.2mm

\sloppy

\pagestyle{plain}

\title{Чеклист по оформлению репозитория}

\begin{document}

\maketitle

\section*{Чеклист по оформлению репозитория}

\begin{tabu} {| X[0.1 l p] | X[2 l p] | X[0.1 l p] |}
    \tabucline-
    \everyrow{\tabucline-}
    1  & Лицензия                                                                   & \\
    2  & Лицензия правильно применяется к репозиторию                               & \\
    3  & Используемые третьесторонние компоненты и материалы совместимы с лицензией & \\
    4  & Настроенный CI                                                             & \\
    5  & Модульные тесты в CI                                                       & \\
    6  & Линтер в CI                                                                & \\
    7  & В репозитории нет результатов сборки, настроен .gitignore                  & \\
    8  & В репозитории нет секретной информации (паролей, ключей и т.п.)            & \\
    9  & Различные сторонние анализаторы (если уместно)                             & \\
    10 & README.md, плашки CI и анализаторов                                        & \\
    11 & README.md, общее описание проекта                                          & \\
    12 & README.md, пример использования                                            & \\
    13 & README.md, инструкция по сборке и запуску                                  & \\
    14 & README.md, как помочь проекту (если уместно)                               & \\
    15 & Код соответствует принятому в сообществе стилю кодирования                 & \\
    16 & Имеется техническая документация (в README.md или на вики)                 & \\
    17 & В коде достаточно комментариев                                             & \\
    18 & Комментарии к коммитам адекватны, коммиты показывают историю проекта       & \\
\end{tabu}

\section*{Пояснения}

\begin{enumerate}
    \item Отдавайте предпочтение разрешающим лицензиям. Код мы рекомендуем лицензировать под Apache License 2.0, MIT License, BSD 3-Clause License.
    \item Каждая лицензия имеет требования к тому, как её правильно применить к файлам в репозитории. Например, Apache License 2.0 позволяет себя применять пофайлово, для чего требует включения в лицензируемые файлы стандартного заголовка. Также распространено использование файла LICENSE в корне репозитория и ссылка на него в заголовке каждого файла. Поищите для своей лицензии, как её правильно применять.
    \item Если используете чужую интеллектуальную собственность, найдите на неё лицензию и проверьте, что вы действительно выполняете её требования (например, проект, лицензированный под Apache License 2.0 \emph{не может} использовать код, лицензированный под GPL v2). Если чужой материал не имеет лицензии (например, просто картинка из интернета или кусок кода со Stack Overflow), использовать его \emph{нельзя}.
    \item Если вы используете GitHub, Continuous Integration-систему удобнее всего настраивать на GitHub Actions, однако вполне допустимы и сторонние системы, такие как AppVeyor, CircleCI. Если вы используете компилируемые языки, CI-система должна проверять собирабельность кода в каждой ветке репозитория и при пуллреквесте. Если интерпретируемые, проверять качество кода и работоспособность.
    \item В проекте должны быть модульные тесты (за редкими исключениями, где они неприменимы или бессмысленны), и модульные тесты должны запускаться в CI.
    \item Должен быть настроен форматтер/линтер, следящий за качеством кода, и также запускаться в CI. Если линтер выдаёт ошибки, сборка должна не проходить.
    \begin{itemize}
        \item Например, для F\# линтер --- это FSharpLint, для Python --- flake8, форматтер для F\# --- это Fantomas, для Python --- black. Нет ничего плохого в том, чтобы использовать форматтер и линтер в CI, настроенные так, чтобы некачественный код даже не доходил до фазы сборки.
        \item Запуск линтера может быть отдельной задачей в CI, чтобы не гонять его по нескольку раз в разных конфигурациях сборки.
        \item Имеет смысл сделать запуск линтера локальным pre-commit hook в git, чтобы некорректный код даже не позволяли закоммитить. Если есть возможность интегрировать среду разработки и линтер/форматтер, сделайте это. Например, Visual Studio Code легко подружить с Fantomas, чтобы он запускался при каждом сохранении файла и делал как надо.
    \end{itemize}
    \item На GitHub файл .gitignore можно выбрать при создании репозитория, но также часто требуется ручная модификация. Должно быть так, чтобы все файлы, которые .gitignore позволяет закоммитить, реально нужно было коммитить. \emph{В репозитории не должно быть результатов сборки,} (то есть папок bin, obj, pycache и т.п.), в идеале не должно быть бинарных файлов вовсе (только если очень надо и вы реально знаете, что делаете).
    \item Разумеется, в репозитории (включая историю коммитов) не должно быть ничего, что вы не хотели бы публиковать (например, ключей авторизации от сообществ ВКонтакте). Если пользуетесь GitHub, кое-что он умеет ловить сам, для этого надо убедиться, что в <<Settings/Code security and analysis>> включено <<Push protection>>. Но, разумеется, большую часть секретов он не найдёт.
    \item Используйте сторонние анализаторы для слежения за качеством кода: например, CodeCov для анализа тестового покрытия, CodeFactor или Codacy как продвинутый статический анализатор. Чем больше инструментов следят за тем, что всё хорошо, тем лучше.
    \item Добавьте в README.md плашки CI и анализаторов (штучки, на которых написано <<CI passing>> или что-то такое). В документации конкретной CI-системы или анализатора обычно легко найти, как добавить плашку в Markdown. Это поможет посетителям сразу посмотреть статус кода.
    \item Напишите в README.md пару абзацев текста, про что вообще проект. Помните, что код вы пишете не только для себя, в ваш репозиторий придут люди, которые вообще не имеют идей, о чём это.
    \item Опишите типичный пример использования, если уместно, с картинками или gif-ками. Включая информацию, откуда брать датасеты, куда подкладывать конфигурацию и т.п., чтобы любой пользователь мог с чистого листа запустить проект и понять, что у него получилось.
    \item Опишите также действия по сборке и внешние зависимости (версию используемых SDK и т.п.). Это всё есть в CI, но в README это всё должно быть в удобной человекочитаемой форме и заодно приводить к развёртыванию окружения, пригодного для работы над проектом (тогда как сборка в CI может быть весьма хитрой, использовать несколько Docker-образов и т.п.).
    \item Если проект предполагает возможность стороннего участия (то есть имеет хоть один шанс стать знаменитым), опишите, как сторонний человек может вам помочь:
    \begin{itemize}
        \item куда и как писать баги;
        \item как связаться с разработчиками;
        \item как контрибьютить;
        \item где посмотреть техническую документацию и найти первый вводный баг, который можно поправить.
    \end{itemize}
    \item Проверьте, что код в репозитории адекватно оформлен. Если на Python, то PEP-8, если на C++, то в соответствии с Core Guidelines и т.п. --- у каждого языка и даже у некоторых фреймворков есть свой стиль кодирования, проверьте, что код его уважает. Если в проекте используется свой стиль кодирования, он должен быть явно задокументирован и весь код должен ему соответствовать.
    \item Где-то должно быть некое техническое описание проекта --- из каких компонентов он состоит, кто за что отвечает. В идеале --- полноценная архитектурная документация в виде страниц на вики, с UML-диаграммами, но если сил нет, можно ограничиться разделом в README, где кратко словами всё описать. Также вместе с/вместо вики может быть уместна документация на Read The Docs.
    \item В коде должны быть комментарии (в принятом для языка формате --- DocString, Doxygen, Javadoc, XML Documentation и т.п.), хотя бы у ключевых классов/интерфейсов/модулей, кратко описывающие, что вообще делает класс. В идеале --- для всего, что public, с документированием предположений о входных данных, инвариантов, бросаемых исключений и свойств потокобезопасности (reentrant, thread-safe и т.п.), но насколько сил хватит.
    \begin{itemize}
        \item В идеале --- по комментариям в коде должна автоматически генерироваться документация и выкладываться на GitHub Pages или тот же Read The Docs (в т.ч. как действие при сборке в CI, то есть полностью автоматически). Например, Для Python есть инструмент Sphinx, который в этом помогает.
    \end{itemize}
    \item Комментарии к коммитам пост-фактум исправить тяжело, поэтому за ними надо следить изначально. Рекомендуется следовать соглашению Conventional Commits. Если у вас в репозитории больше пяти маловменяемых комментариев (типа <<fix>>) подряд, лучше либо сделайте squash и склейте коммиты в один, либо измените всю историю через git rebase -i. Коммиты не должны быть сделаны в последний день, а должны показывать, как шла работа, от создания пустого проекта до последнего релиза. Фразы вида <<я тут локально разрабатывал, потом выложил, как получилось что-то разумное>> очень сильно огорчают комиссию. Могут помочь инструменты типа Mergeable, Mergify.
\end{enumerate}

\section*{Чеклист по оформлению пуллреквеста}

\begin{tabu} {| X[0.1 l p] | X[2 l p] | X[0.1 l p] |}
    \tabucline-
    \everyrow{\tabucline-}
    1 & Адекватное название                                                                                   & \\
    2 & Описание пуллреквеста, список предлагаемых изменений (если применимо, со ссылками на закрытые issues) & \\
    3 & Описание пуллреквеста, описание работы предлагаемой функциональности (если возможно, с gif-кой демо)  & \\
    4 & Описание пуллреквеста, техническое описание, изменения в архитектуре                                  & \\
    5 & Модульные тесты на новый код                                                                          & \\
    6 & CI проходит, при необходимости подредактирован, чтобы запускать новый код                             & \\
    7 & Содержимое пуллреквеста лицензионно совместимо с основным репозиторием                                & \\
    8 & Коммиты в истории следуют принятым в проекте соглашениям (отдельные или склеены в один)               & \\
    9 & Стиль кодирования соответствует стилю проекта                                                         & \\
\end{tabu}

\section*{Пояснения}

\begin{enumerate}
    \setcounter{enumi}{2}
    \item Анимированные gif-файлы легко делаются инструментами для захвата экрана (например, ScreenToGIF), и очень нужны, когда делается что-то в UI (например, чтобы наглядно показать, как было --- как стало). 
    \begin{itemize}
        \item Если пуллреквест что-то ускоряет, приложите графики замера времени (или flame graphs из вашего любимого профилятора --- вы ведь не пытаетесь что-то ускорить без профилятора, да?), показывающие ускорение. Если пуллреквест улучшает какой-то классификатор, приложите ROC-кривую или что-нибудь такое. Если занимаетесь машинным зрением, выложите кучу наглядных скриншотов. Вообще, активно используйте наглядные иллюстрации того, почему именно пуллреквест должны принять.
    \end{itemize}
    \item Для описания архитектуры используйте UML-диаграммы (см. \url{https://www.uml-diagrams.org/} как краткий справочник по стандарту, избегайте UML-like картинок). Выделите цветом, что поменялось. Текстом опишите, что на диаграмме нарисовано (одна диаграмма архитектуру не описывает).
\end{enumerate}

\section*{Полезные ссылки для любопытных}

\begin{itemize}
    \item Правильное именование коммитов: \url{https://www.conventionalcommits.org/en/v1.0.0/}.
    \item Исправление комментариев к коммитам, редактирование истории (не делайте так без крайней нужды): \url{https://git-scm.com/book/en/v2/Git-Tools-Rewriting-History}.
    \item Хорошее описание .gitignore: \url{https://www.atlassian.com/ru/git/tutorials/saving-changes/gitignore}.
    \item Модели работы с ветками: 
    \begin{itemize}
        \item \url{https://www.atlassian.com/ru/git/tutorials/comparing-workflows};
        \item \url{https://www.gitkraken.com/learn/git/best-practices/git-branch-strategy};
        \item \url{https://www.endoflineblog.com/oneflow-a-git-branching-model-and-workflow}.
    \end{itemize}
    \item Зачем нужен README.md и как его писать: \url{https://bulldogjob.com/readme/how-to-write-a-good-readme-for-your-github-project}.
    \item Шаблон README с плашками и другими хорошими вещами: \url{https://github.com/othneildrew/Best-README-Template}.
    \item Подборка примеров хороших README: \url{https://github.com/matiassingers/awesome-readme}.
    \item Генератор README: \url{https://readme.so/ru}.
    \item Гайд по лицензиям от GitHub: \url{https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/licensing-a-repository}.
    \item Слайды лекции про авторские права в IT от Я.А. Кириленко: \url{https://docs.google.com/presentation/d/1-xMvM_EyouDM9slBpQHR3h7MRgYrMQCKZ2dxYeFKh20}.
    \item Может быть полезен dependabot (\url{https://docs.github.com/en/code-security/dependabot}), для автоматического обновления внешних зависимостей в проекте. 
\end{itemize}

\end{document}